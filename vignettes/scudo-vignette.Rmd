---
title: "SCUDO: Signature-based Clustering for Diagnostic Purposes"
date: "`r Sys.Date()`"
author:
- name: Matteo Ciciani
  affiliation: &aff CIBIO, Univ. of Trento, Trento, Italy
- name: Thomas Cantore
  affiliation: *aff
- name: Enrica Colasurdo
  affiliation: *aff
output:
    BiocStyle::html_document:
        toc_float: true
vignette: >
  %\VignetteIndexEntry{SCUDO: Signature-based Clustering for Diagnostic Purposes}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
abstract: This package implements in R the SCUDO pipeline proposed in Lauria (2013) and Lauria, Moyseos, Priami (2015).
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# An introduction about the method

...

# Example

Example using the `r Biocpkg("ALL")` package, containing data of T- and B-cell Acute Lymphocytic Leukemia.

## Load required packages and explore data

```{r, message=FALSE}
library(scudo)
library(ALL)
data(ALL)
```

We cab extract the expression data and the samples annotation.

```{r}
expData <- exprs(ALL)
dim(expData)
phenoData <- pData(ALL)
```

`expData` contains mRNA expression measurements for 128 samples and 12625 features. The factor `phenoData$BT` classifies the samples as B- or T-cell lymphocytic leukemia:

```{r}
summary(phenoData$BT)
```

We can see that there are different classes of B- and T-cell leukemia. For now we can simplify this, keeping only the distinction between B- and T-cells.

```{r}
bt <- as.factor(stringr::str_extract(phenoData$BT, "^."))
summary(bt)
```

## Perform analysis

For now the input has to be a data.frame, soon we will add matrices and ExpressionSets.

```{r}
expData <- as.data.frame(expData)
ScudoRes <- scudo(expData, groups = bt, nTop = 100, nBottom = 100, pValue = 0.1)
ScudoRes
```

From this object we can extract the signatures for each sample and the consensus signatures for each group.

```{r}
UpSig <- UpSignatures(ScudoRes)
UpSig[1:5,1:5]
ConsUpSig <- ConsensusUpSignatures(ScudoRes)
ConsUpSig[1:5, ]
```

The object `ScudoRes` can be used to generate a network of samples, as an `r CRANpkg("igraph")`object, using the function `ScudoNetwork`.

```{r}
net <- ScudoNetwork(ScudoRes, N = 0.2)
```

The parameter `N` controls the percentage of edges to keep in the network. We can plot this network using the usual `plot` function.

```{r}
plot(net)
```

This plot is useful to have a quick look at the network, but is rather ugly. We can render the network in Cytoscape, using the function `ScudoCytoscape`. Note that Cytoscape has to be open when running the function.

```{r, eval=FALSE}
ScudoCytoscape(net)
```

# References

Mario Lauria. Rank-based transcriptional signatures. Systems Biomedicine. 2013; 1(4):228-239.

Mario Lauria, Petros Moyseos and Corrado Priami. SCUDO: a tool for signature-based clustering of expression profiles. Nucleic Acids Research. 2015; 43(W1):W188-92.

